---
permalink: config-windows/iscsi-perform-specific-task.html 
sidebar: sidebar 
keywords: iSCSI, switches, IP network configuration, express Windows configuration, software configuration, Windows host, E2800, E5700, EF300, EF600, E-Series, eseries 
summary: 對於iSCSI傳輸協定、您可以在陣列端和主機端設定交換器和網路。然後驗證IP網路連線。 
---
= 執行iSCSI專屬工作
:allow-uri-read: 
:experimental: 
:icons: font
:imagesdir: ../media/


[role="lead"]
對於iSCSI傳輸協定、您可以設定交換器、在陣列端和主機端設定網路、然後驗證IP網路連線。



== 步驟1：設定交換器- iSCSI、Windows

您可以根據廠商的iSCSI建議來設定交換器。這些建議可能同時包含組態指令和程式碼更新。

.開始之前
請確定您擁有下列項目：

* 兩個獨立的網路提供高可用度。請務必使用VLAN或兩個獨立的網路、將iSCSI流量隔離至不同的網路區段。
* 已啟用「傳送及接收硬體流程控制*端點對端點*」。
* 停用優先順序流程控制。
* 如果適用、請啟用巨型框架。



NOTE: 控制器的交換器連接埠不支援連接埠通道/LACP。不建議使用主機端LACP；多重路徑可提供相同或更好的效益。

.步驟
請參閱交換器廠商的文件。



== 步驟2：設定網路功能- iSCSI Windows

您可以根據資料儲存需求、以多種方式設定iSCSI網路。如需為環境選擇最佳組態的秘訣、請洽詢您的網路管理員。

使用基本備援設定iSCSI網路的有效策略、是將每個主機連接埠和每個控制器的一個連接埠、分別連接不同的交換器、並使用VLAN將每組主機和控制器連接埠分割成不同的網路區段。

.開始之前
請確定您擁有下列項目：

* 已啟用「傳送及接收硬體流程控制*端點對端點*」。
* 停用優先順序流程控制。
* 如果適用、請啟用巨型框架。
+
如果您基於效能考量而在IP SAN中使用巨型框架、請務必將陣列、交換器和主機設定為使用巨型框架。如需如何在主機和交換器上啟用巨型框架的資訊、請參閱作業系統和交換器文件。若要在陣列上啟用巨型框架、請完成步驟3中的程序。



.步驟
請參閱交換器廠商的文件。


NOTE: 許多網路交換器必須設定在超過9、000位元組的IP負荷上。如需詳細資訊、請參閱交換器文件。



== 步驟3：設定陣列端的網路功能、例如iSCSI、Windows

您可以使用SANtricity 支援支援系統的圖形使用者介面、在陣列端設定iSCSI網路。

.開始之前
* 其中一個儲存陣列控制器的IP位址或網域名稱。
* System Manager GUI、角色型存取控制（RBAC）或LDAP的密碼、以及為儲存陣列的適當安全存取設定的目錄服務。如SANtricity 需存取管理的詳細資訊、請參閱《支援系統》線上說明。


.關於這項工作
本工作說明如何從「硬體」頁面存取iSCSI連接埠組態。您也可以從功能表：系統[設定>設定iSCSI連接埠]存取組態。

.步驟
. 在瀏覽器中輸入下列URL：「+https://<DomainNameOrIPAddress>+`」
+
「IPAddress」是其中一個儲存陣列控制器的位址。

+
第一次SANtricity 在尚未設定的陣列上開啟時、會出現「Set Administrator Password（設定管理員密碼）」提示字元。角色型存取管理可設定四種本機角色：管理、支援、安全性及監控。後三個角色的隨機密碼是無法猜測的。設定管理員角色的密碼之後、您可以使用管理員認證來變更所有密碼。如SANtricity 需四種本機使用者角色的詳細資訊、請參閱《支援系統》線上說明。

. 在Set Administrator Password（設定管理員密碼）和Confirm Password（確認密碼）欄位中輸入管理員角色的System Manager密碼、然後選取* Set Password（設定密碼）*按鈕。
+
當您開啟System Manager且未設定集區、磁碟區群組、工作負載或通知時、安裝精靈便會啟動。

. 關閉設定精靈。
+
稍後您將使用精靈來完成其他設定工作。

. 選取*硬體*。
. 如果圖形顯示磁碟機、請按一下*顯示磁碟櫃背面*。
+
圖形會變更、以顯示控制器而非磁碟機。

. 按一下要設定iSCSI連接埠的控制器。
+
此時會出現控制器的內容功能表。

. 選取*設定iSCSI連接埠*。
+
此時將打開Configure iSCSI Portes（配置iSCSI端口）對話框。

. 在下拉式清單中、選取您要設定的連接埠、然後按一下「*下一步*」。
. 選取組態連接埠設定、然後按一下「*下一步*」。
+
若要查看所有連接埠設定、請按一下對話方塊右側的*顯示更多連接埠設定*連結。

+
|===
| 連接埠設定 | 說明 


 a| 
已設定乙太網路連接埠速度
 a| 
選取所需的速度。下拉式清單中顯示的選項取決於網路可支援的最大速度（例如10 Gbps）。


NOTE: E5700和EF570控制器中的選用iSCSI主機介面卡不會自動交涉速度。您必須將每個連接埠的速度設定為10 GB或25 GB。所有連接埠都必須設定為相同的速度。



 a| 
啟用IPV4 /啟用IPv6
 a| 
選取一個或兩個選項、以啟用對IPv4和IPv6網路的支援。



 a| 
TCP接聽連接埠（按一下*顯示更多連接埠設定*即可取得）。
 a| 
如有必要、請輸入新的連接埠號碼。接聽連接埠是控制器用來接聽來自主機iSCSI啟動器之iSCSI登入的TCP連接埠號碼。預設的接聽連接埠為3260。您必須輸入3260或49152到65535.之間的值。



 a| 
MTU大小（按一下*顯示更多連接埠設定*即可取得）。
 a| 
如有必要、請為最大傳輸單元（MTU）輸入新的位元組大小。預設的最大傳輸單元（MTU）大小為每個框架1500位元組。您必須輸入介於1500和9000之間的值。



 a| 
啟用ICMP Ping回應
 a| 
選取此選項可啟用網際網路控制訊息傳輸協定（ICMP）。網路電腦的作業系統會使用此傳輸協定來傳送訊息。這些ICMP訊息可判斷主機是否可連線、以及從該主機取得封包所需的時間。

|===
+
如果您選取*啟用IPV4、則會在您按一下*下一步*之後、開啟一個對話方塊、供您選取IPV4設定。如果您選取*啟用IPv6 *、則會在您按一下*下一步*之後、開啟一個對話方塊來選取IPv6設定。如果您同時選取這兩個選項、則會先開啟[IPV4設定]對話方塊、然後按一下[* Next*（*下一步*）]之後、隨即開啟[IPv6設定]對話方塊。

. 自動或手動設定IPv6和/或IPv6設定。若要查看所有連接埠設定、請按一下對話方塊右側的*顯示更多設定*連結。
+
|===
| 連接埠設定 | 說明 


 a| 
自動取得組態
 a| 
選取此選項可自動取得組態。



 a| 
手動指定靜態組態
 a| 
選取此選項、然後在欄位中輸入靜態位址。對於IPV4、請加入網路子網路遮罩和閘道。對於IPv6、請包含可路由的IP位址和路由器IP位址。



 a| 
啟用VLAN支援（按一下*「Show More settings（顯示更多設定）」*即可取得。）
 a| 

NOTE: 此選項僅適用於iSCSI環境。在NVMe over RoCE環境中無法使用。

選取此選項可啟用VLAN並輸入其ID。VLAN是一種邏輯網路、其運作方式類似於實體獨立於其他實體和虛擬區域網路（LAN）、這些區域網路由相同的交換器、相同的路由器或兩者支援。



 a| 
啟用乙太網路優先順序（按一下*顯示更多設定*即可取得）。
 a| 

NOTE: 此選項僅適用於iSCSI環境。在NVMe over RoCE環境中無法使用。

選取此選項可啟用決定存取網路優先順序的參數。使用滑桿選取1到7之間的優先順序。在共享區域網路（LAN）環境（例如乙太網路）中、許多站台可能會爭用網路存取權。存取權以先到先得的方式提供。兩個站台可能會同時嘗試存取網路、這會導致兩個站台都關機並等待、然後再試一次。交換式乙太網路只有一個站台連接到交換器連接埠、此程序就會最小化。

|===
. 單擊*完成*。
. 關閉System Manager。




== 步驟4：設定主機端網路功能- iSCSI

您必須在主機端設定iSCSI網路、才能讓Microsoft iSCSI啟動器與陣列建立工作階段。

.開始之前
請確定您擁有下列項目：

* 將用於傳輸iSCSI儲存流量的完整設定交換器。
* 已啟用「傳送及接收硬體流程控制*端點對端點*」
* 停用優先順序流程控制。
* 陣列端iSCSI組態已完成。
* 控制器上每個連接埠的IP位址。


.關於這項工作
這些指示假設iSCSI流量將使用兩個NIC連接埠。

.步驟
. 停用未使用的網路卡傳輸協定。
+
這些通訊協定包括但不限於QoS、檔案與列印共用及NetBios。

. 從主機上的終端視窗執行「iscsicpl.exe」、以開啟「* iSCSI啟動器內容*」對話方塊。
. 在「**探索*」索引標籤上、選取「*探索入口網站*」、然後輸入其中一個iSCSI目標連接埠的IP位址。
. 在「**目標*」索引標籤上、選取您發現的第一個目標入口網站、然後選取「*連線*」。
. 選取*啟用多重路徑*、選取*將此連線新增至最愛目標清單*、然後選取*進階*。
. 對於*本機介面卡*、請選取* Microsoft iSCSI啟動器*。
. 對於*啟動器IP*、請選取與其中一個iSCSI目標位於同一子網路或VLAN上的連接埠IP位址。
. 對於*目標IP*、請選取與上述步驟所選*啟動器IP*位於同一子網路上的連接埠IP位址。
. 保留其餘核取方塊的預設值、然後選取*確定*。
. 返回*連線到目標*對話方塊時、請再次選取*確定*。
. 針對您要建立的儲存陣列、對每個啟動器連接埠和工作階段（邏輯路徑）重複此程序。
+
image::../media/82012_00.gif[82012 00]





== 步驟5：驗證IP網路連線- iSCSI、Windows

您可以使用ping測試來驗證網際網路傳輸協定（IP）網路連線、以確保主機和陣列能夠通訊。

. 選取功能表：開始[所有程式>附屬應用程式>命令提示字元]、然後使用Windows CLI執行下列其中一個命令、視是否啟用巨型框架而定：
+
** 如果未啟用巨型框架、請執行下列命令：
+
[listing]
----
ping -S <hostIP\> <targetIP\>
----
** 如果啟用巨型框架、請執行有效負載大小為8、972位元組的ping命令。IP和ICMP的合併標頭為28個位元組、新增至有效負載時、等於9、000個位元組。f交換器會設定「do’t fragment（DF）」位元。l交換器可讓您設定大小。這些選項可在iSCSI啟動器與目標之間成功傳輸9、000個位元組的巨型框架。
+
[listing]
----
ping -l 8972 -f <iSCSI_target_IP_address\>
----
+
在此範例中、iSCSI目標IP位址為「192.0.2.8」。

+
[listing]
----
C:\>ping -l 8972 -f 192.0.2.8
Pinging 192.0.2.8 with 8972 bytes of data:
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Ping statistics for 192.0.2.8:
  Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
  Minimum = 2ms, Maximum = 2ms, Average = 2ms
----


. 從每個主機的啟動器位址（用於iSCSI的主機乙太網路連接埠IP位址）發出「ping」命令、命令至每個控制器iSCSI連接埠。從組態中的每個主機伺服器執行此動作、視需要變更IP位址。
+

NOTE: 如果命令失敗（例如、傳回「Packet to be f破碎、但DF set」）、請驗證主機伺服器、儲存控制器和交換器連接埠上乙太網路介面的MTU大小（巨型框架支援）。





== 步驟6：記錄您的組態

您可以產生及列印本頁的PDF、然後使用下列工作表記錄iSCSI儲存組態資訊。您需要這些資訊來執行資源配置工作。



=== 建議的組態

建議的組態包括兩個啟動器連接埠、以及四個具有一或多個VLAN的目標連接埠。

image::../media/50001_01_conf-win.gif[50001 01會議獲勝]



=== 目標IQN

|===
| 標註編號 | 目標連接埠連線 | IQN 


 a| 
2.
 a| 
目標連接埠
 a| 

|===


=== 對應主機名稱

|===
| 標註編號 | 主機資訊 | 名稱與類型 


 a| 
1.
 a| 
對應主機名稱
 a| 



 a| 
 a| 
主機作業系統類型
 a| 

|===